import{b as n,u as z,j as e,i as S,f,y as v}from"./index-49jQCupm.js";const B=()=>{const[a,h]=n.useState(null),[N,b]=n.useState(!0),[y,x]=n.useState(!1),[d,u]=n.useState({}),[p,g]=n.useState(!1),o=z();if(n.useEffect(()=>{let l=!0;return(async()=>{try{const i=await f.get("/profile",{withCredentials:!0});if(!l)return;const s=i.data.user||i.data;h(s),u({username:s.username||"",email:s.email||"",mobile:s.mobile||s.phone||"",address:s.address||"",city:s.city||"",state:s.state||"",zipCode:s.zipCode||"",dateOfBirth:s.dateOfBirth?new Date(s.dateOfBirth).toISOString().slice(0,10):"",gender:s.gender||"",password:""})}catch{o("/login")}finally{l&&b(!1)}})(),()=>{l=!1}},[o]),N)return e.jsx("div",{className:"text-center mt-20",children:"Loading profile..."});if(!a)return e.jsx("div",{className:"text-center mt-20 text-gray-600",children:"Profile not available"});const r=l=>{const{name:c,value:i}=l.target;u(s=>({...s,[c]:i}))},w=async l=>{var c,i,s,j;l.preventDefault(),g(!0);try{const t={...d};t.password||delete t.password;const m=await f.put("/profile",t,{withCredentials:!0});v.success("Profile updated"),h(m.data.user||m.data),x(!1),u(C=>({...C,password:""}))}catch(t){console.error("Profile update error:",(t==null?void 0:t.response)||t);const m=((i=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:i.error)||((j=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:j.message)||"Update failed";v.error(m)}finally{g(!1)}};return e.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[e.jsx(S,{}),e.jsx("h1",{className:"text-4xl font-medium mb-4",children:"My Profile"}),y?e.jsxs("form",{onSubmit:w,className:"bg-white p-6 rounded-xl shadow space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-zinc-800",children:"Username"}),e.jsx("input",{name:"username",value:d.username,onChange:r,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-zinc-800",children:"Email"}),e.jsx("input",{name:"email",value:d.email,onChange:r,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-zinc-800",children:"Phone"}),e.jsx("input",{name:"mobile",value:d.mobile,onChange:r,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-zinc-800",children:"Gender"}),e.jsx("input",{name:"gender",value:d.gender,onChange:r,className:"w-full p-2 border rounded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-zinc-800",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"dateOfBirth",value:d.dateOfBirth,onChange:r,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-zinc-800",children:"Address"}),e.jsx("input",{name:"address",value:d.address,onChange:r,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx("input",{name:"city",value:d.city,onChange:r,placeholder:"City",className:"p-2 border rounded"}),e.jsx("input",{name:"state",value:d.state,onChange:r,placeholder:"State",className:"p-2 border rounded"}),e.jsx("input",{name:"zipCode",value:d.zipCode,onChange:r,placeholder:"Zip",className:"p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"New Password (leave blank to keep current)"}),e.jsx("input",{name:"password",type:"password",value:d.password,onChange:r,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:p,className:"px-4 py-2 bg-zinc-900 text-white rounded hover:bg-zinc-950",children:p?"Saving...":"Save"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border rounded",children:"Cancel"})]})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Username"}),e.jsx("div",{className:"font-medium text-lg",children:a.username})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("div",{className:"font-medium",children:a.email})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Phone"}),e.jsx("div",{className:"font-medium",children:a.mobile||a.phone||"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Gender"}),e.jsx("div",{className:"font-medium",children:a.gender||"—"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Date of Birth"}),e.jsx("div",{className:"font-medium",children:a.dateOfBirth?new Date(a.dateOfBirth).toLocaleDateString():"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Address"}),e.jsx("div",{className:"font-medium",children:a.address||"—"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[a.city?`${a.city}, `:"",a.state?`${a.state} `:"",a.zipCode?` - ${a.zipCode}`:""]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>o("/orders"),className:"px-4 py-2 bg-black text-white rounded",children:"My Orders"}),e.jsx("button",{onClick:()=>o("/"),className:"px-4 py-2 border rounded",children:"Back to Store"}),e.jsx("button",{onClick:()=>x(!0),className:"px-4 py-2 border rounded bg-zinc-950 text-white",children:"Edit Profile"})]})]})]})};export{B as default};
