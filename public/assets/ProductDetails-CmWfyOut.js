import{k as P,u as C,d as E,b as n,f as b,j as t}from"./index-49jQCupm.js";import{P as A}from"./ProductCard-G7S-sDkh.js";const $=()=>{const{id:o}=P(),h=C(),j=E(e=>e.user.user),[s,v]=n.useState(null),[f,w]=n.useState([]),[l,i]=n.useState(""),[d,c]=n.useState(!1),[x,y]=n.useState("");n.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"});let e=!0;return(async()=>{try{const a=await b.get(`/products/${o}`);if(!e)return;const r=a.data;if(v(r),i(Array.isArray(r.images)&&r.images.length>0?r.images[0]:r.image||""),r.category){const k=encodeURIComponent(r.category),p=await b.get(`/products?category=${k}`);e&&Array.isArray(p.data)&&w(p.data.filter(z=>z._id!==r._id))}}catch{y("Product not found")}})(),()=>e=!1},[o]);const N=e=>{if(!j){h(`/login?redirect=${encodeURIComponent(`/checkout/${o}?quantity=1`)}`);return}h(`/checkout/${o}`,{state:{quantity:1}})},m=()=>Array.isArray(s==null?void 0:s.images)?s.images:s!=null&&s.image?[s.image]:[],u=n.useCallback(()=>{const e=m();if(!e.length)return;const a=(e.indexOf(l)+1)%e.length;i(e[a])},[l,s]),g=n.useCallback(()=>{const e=m();if(!e.length)return;const a=(e.indexOf(l)-1+e.length)%e.length;i(e[a])},[l,s]);return n.useEffect(()=>{if(!d)return;const e=a=>{a.key==="ArrowRight"&&u(),a.key==="ArrowLeft"&&g(),a.key==="Escape"&&c(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[d,u,g]),s?t.jsxs("div",{className:"min-h-screen bg-white text-zinc-900 px-4 py-8",children:[t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"rounded-2xl shadow-xl bg-white overflow-hidden border border-zinc-200",children:t.jsxs("div",{className:"flex flex-col lg:flex-row",children:[t.jsxs("div",{className:"lg:w-1/2 p-4 flex flex-col items-center",children:[t.jsx("img",{src:l,alt:s.title,loading:"lazy",decoding:"async",className:"w-full h-[480px] object-cover rounded-xl cursor-pointer transition-transform duration-300 hover:scale-105",onClick:()=>c(!0),onError:e=>e.target.src="/fallback.jpg"}),t.jsx("div",{className:"flex gap-2 mt-4 overflow-x-auto",children:m().map((e,a)=>t.jsx("button",{onClick:()=>i(e),className:`border-2 rounded-lg p-0.5 transition-all duration-200 ${e===l?"border-zinc-900":"border-transparent hover:border-zinc-400"}`,children:t.jsx("img",{src:e,alt:`thumb-${a}`,loading:"lazy",decoding:"async",className:"h-16 w-16 object-cover rounded-md",onError:r=>r.target.src="/fallback.jpg"})},a))})]}),t.jsxs("div",{className:"lg:w-1/2 p-8 flex flex-col justify-center space-y-8",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-4xl lg:text-5xl font-extrabold mb-4",children:s.title}),t.jsx("p",{className:"text-zinc-700 text-lg leading-relaxed",children:s.description}),t.jsxs("div",{className:"flex items-center gap-4 mt-6",children:[t.jsxs("span",{className:"text-4xl font-bold text-zinc-900",children:["₹ ",s.price]}),t.jsx("div",{className:"h-6 w-px bg-zinc-300"}),t.jsx("span",{className:"text-zinc-500 text-sm",children:"Premium Quality"})]})]}),x&&t.jsx("div",{className:"bg-red-100 border border-red-300 rounded-xl p-4 text-red-700",children:x}),t.jsx("button",{onClick:N,className:"px-8 py-4 bg-zinc-900 text-white rounded-xl font-semibold hover:bg-zinc-800 transition-transform duration-300 hover:scale-105 shadow-md",children:"Buy Now"})]})]})}),f.length>0&&t.jsxs("div",{className:"mt-12",children:[t.jsx("h3",{className:"text-2xl font-semibold mb-6",children:"Related Products"}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:f.map(e=>t.jsx(A,{product:e},e._id))})]})]}),d&&t.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",onClick:()=>c(!1),children:[t.jsx("button",{onClick:e=>{e.stopPropagation(),g()},className:"absolute left-6 text-white text-4xl hover:text-gray-400",children:"‹"}),t.jsx("img",{src:l,alt:"preview",loading:"lazy",decoding:"async",className:"max-w-[90vw] max-h-[90vh] rounded-lg shadow-2xl",onClick:e=>e.stopPropagation()}),t.jsx("button",{onClick:e=>{e.stopPropagation(),u()},className:"absolute right-6 text-white text-4xl hover:text-gray-400",children:"›"}),t.jsx("button",{onClick:()=>c(!1),className:"absolute top-6 right-8 text-4xl text-white hover:text-gray-400",children:"×"})]})]}):t.jsx("div",{className:"min-h-screen bg-white flex justify-center items-center text-zinc-900",children:t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx("div",{className:"w-14 h-14 border-4 border-zinc-900 border-t-transparent rounded-full animate-spin mx-auto"}),t.jsx("p",{className:"text-xl",children:x||"Loading product..."})]})})};export{$ as default};
